<div class="zen-container">
  
  <div class="notification-scroll" *ngIf="notification$ | async as msg">
    <span class="symbol">ğŸ€„</span> {{ msg }}
  </div>

  <header class="header-section">
    <h1>DÅjÅ des TÃ¢ches</h1>
    <p class="subtitle">La clartÃ© de l'esprit prÃ©cÃ¨de l'action</p>
  </header>

  <app-task-stats></app-task-stats>

  <div class="mission-scroll-form">
    <h3>ğŸ“œ Nouvel Ordre de Mission</h3>
    
    <div class="form-group">
      <input type="text" 
             [(ngModel)]="newTask.title" 
             (keyup.enter)="addTask()"
             placeholder="Titre de la mission..." 
             class="zen-input title-input">
    </div>
    
    <div class="form-group">
      <textarea [(ngModel)]="newTask.description" 
                (keydown.control.enter)="addTask()"
                placeholder="DÃ©tails stratÃ©giques (optionnel)..." 
                rows="2" 
                class="zen-input desc-input"></textarea>
    </div>

    <button class="btn-hanko-large" (click)="addTask()">
      SCELLER L'ORDRE
    </button>
  </div>

  <div class="modal-overlay" *ngIf="editingTask">
    <app-task-edit 
      [initialTitle]="editingTask.title" 
      [initialDescription]="editingTask.description || ''"
      (saveTask)="onSaveEdit($event)"
      (cancel)="cancelEdit()">
    </app-task-edit>
  </div>

  <div class="samurai-grid">
    <div *ngFor="let task of tasks$ | async" 
         class="samurai-card" 
         (click)="toggleComplete(task.id)"
         [class.completed-card]="task.completed"
         [class.illuminated-card]="task.isHighlighted"> 
         
      <div class="card-visual">
        <img [src]="'https://api.dicebear.com/9.x/adventurer/svg?seed=' + task.id + '&backgroundColor=b6e3f4,c0aede,d1d4f9'" 
             alt="Samurai Avatar" 
             class="samurai-img">
        <div class="glow-aura" *ngIf="task.isHighlighted"></div>
      </div>

      <div class="card-content">
        <h3 class="task-title">
          {{ task.title }}
        </h3>
        
        <p class="task-desc" *ngIf="task.description">
          {{ task.description }}
        </p>

        <div class="tags">
          <span class="status-badge" [class.done]="task.completed">
            {{ task.completed ? 'Vaincu' : 'En cours' }}
          </span>
        </div>
      </div>

      <div class="card-actions">
        <button class="action-btn gold" 
                (click)="toggleHighlight(task.id); $event.stopPropagation()" 
                [class.active-star]="task.isHighlighted"
                title="Illuminer (PrioritÃ©)">
          {{ task.isHighlighted ? 'ğŸŒŸ' : 'â­' }}
        </button>
        
        <button class="action-btn ink" 
                (click)="startEdit(task); $event.stopPropagation()" 
                title="StratÃ©gie">
          âœ’ï¸
        </button>
        
        <button class="action-btn red" 
                (click)="deleteTask(task.id); $event.stopPropagation()" 
                title="ExÃ©cuter">
          âš”ï¸
        </button>
      </div>

    </div>
  </div>
  
  <div class="footer-decoration">
    <span class="wave-pattern"></span>
  </div>
</div>